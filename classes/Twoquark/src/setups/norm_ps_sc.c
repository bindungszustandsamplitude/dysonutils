vec<cdouble> w(1000,0.);
cdouble i_(0.,1.);

    w[1]=P_K;
    w[2]=q_K;
    w[3]=P_q;
    w[4]=q_q;
    w[5]=P_P;
    w[6]=K_K;
   w[7]=ssm*svp;
   w[8]=ssp*svm;
   w[9]=w[7] - w[8];
   w[10]=w[9]*eta;
   w[10]=w[10] + w[8];
   w[11]=w[10]*w[1];
   w[12]=w[9]*w[2];
   w[11]=w[11] + w[12];
   w[11]=4.E+0*w[11];
   w[10]=w[10]*w[3];
   w[9]=w[9]*w[4];
   w[9]=w[10] + w[9];
   w[10]=4.E+0*w[2];
   w[9]=w[9]*w[10];
   w[10]=svp*svm;
   w[12]=w[3]*w[10]*w[2];
   w[13]=w[10]*w[4];
   w[14]=w[13]*w[1];
   w[12]=w[12] - w[14];
   w[12]=8.E+0*w[12];
   w[14]=2.E+0*eta;
   w[15]=w[14] - 1.E+0;
   w[15]=w[10]*w[15];
   w[16]= - w[2]*w[15];
   w[17]=eta - 1.E+0;
   w[17]=w[10]*w[17];
   w[18]=w[17]*w[1];
   w[19]= - eta*w[18];
   w[16]=w[16] + w[19];
   w[16]=w[1]*w[16];
   w[19]=pow(w[2],2);
   w[10]= - w[19]*w[10];
   w[10]=w[10] + w[16];
   w[16]=w[15]*w[3];
   w[20]=w[5]*w[17]*eta;
   w[21]=w[16] + w[20];
   w[22]=ssp*ssm;
   w[23]=w[22] - w[13];
   w[24]= - w[23] + w[21];
   w[24]=w[6]*w[24];
   w[10]=2.E+0*w[10] + w[24];
   w[10]=4.E+0*w[10];
   w[24]=w[14]*w[3];
   w[25]=w[17]*w[24];
   w[15]=w[15]*w[4];
   w[15]=w[25] + w[15];
   w[25]=w[1]*w[2];
   w[15]=w[15]*w[25];
   w[13]=w[22] + w[13];
   w[22]=w[20] - w[13];
   w[22]=w[22]*w[19];
   w[15]=w[15] - w[22];
   w[15]=4.E+0*w[15];
   w[7]=w[7] + w[8];
   w[22]=w[7]*w[4];
   w[26]=w[7]*eta;
   w[8]=w[26] - w[8];
   w[26]=w[8]*w[3];
   w[22]=w[22] + w[26];
   w[22]=w[22]*w[6];
   w[7]=w[7]*w[19];
   w[26]=w[8]*w[25];
   w[7]=w[22] - w[7] - w[26];
   w[7]=8.E+0*w[7];
   w[16]=w[16] - w[20];
   w[20]= - w[13] - w[16];
   w[20]=w[4]*w[20];
   w[14]=w[14]*w[17]*pow(w[3],2);
   w[17]= - w[14] + w[20];
   w[17]=4.E+0*w[17]*w[19];
   w[20]=w[19]*w[3];
   w[22]=w[25]*w[4];
   w[20]=w[20] - w[22];
   w[8]=w[20]*w[8];
   w[8]=8.E+0*w[8];
   w[16]=w[16] - w[23];
   w[19]=w[16]*w[19];
   w[20]=w[2]*w[24];
   w[22]= - w[4]*w[1]*eta;
   w[20]=w[20] + w[22];
   w[18]=w[20]*w[18];
   w[16]= - w[4]*w[16];
   w[14]= - w[14] + w[16];
   w[14]=w[6]*w[14];
   w[14]=w[14] + w[19] + 2.E+0*w[18];
   w[14]=1.6E+1*w[14];
   w[13]=w[13] + w[21];
   w[13]=4.E+0*w[13];

K_norm[SI_K_norm(0,0,iq,iz)] = wj * w[13];

if(n_dirac > 1)
{

K_norm[SI_K_norm(0,1,iq,iz)] = wj * w[11];
K_norm[SI_K_norm(1,0,iq,iz)] = wj * w[11];
K_norm[SI_K_norm(1,1,iq,iz)] = wj * w[10];

if(n_dirac > 2)
{

K_norm[SI_K_norm(0,2,iq,iz)] = wj * w[9];
K_norm[SI_K_norm(1,2,iq,iz)] = wj *  - w[15];
K_norm[SI_K_norm(2,2,iq,iz)] = wj * w[17];
K_norm[SI_K_norm(2,1,iq,iz)] = wj *  - w[15];
K_norm[SI_K_norm(2,0,iq,iz)] = wj * w[9];

if(n_dirac > 3)
{

K_norm[SI_K_norm(0,3,iq,iz)] = wj * w[12];
K_norm[SI_K_norm(1,3,iq,iz)] = wj * w[7];
K_norm[SI_K_norm(2,3,iq,iz)] = wj * w[8];
K_norm[SI_K_norm(3,0,iq,iz)] = wj * w[12];
K_norm[SI_K_norm(3,1,iq,iz)] = wj * w[7];
K_norm[SI_K_norm(3,2,iq,iz)] = wj * w[8];
K_norm[SI_K_norm(3,3,iq,iz)] = wj * w[14];

}
}
}














