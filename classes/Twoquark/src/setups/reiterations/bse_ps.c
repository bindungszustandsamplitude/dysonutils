
    w[1]=1./( - P_P*p_p + pow(P_p,2));
    w[2]=P_P;
    w[3]=p_p;
    w[4]=P_p;
    w[5]=P_k;
    w[6]=p_k;
    w[7]=pow(k_k,-1);
    w[8]=p_q;
    w[9]=q_k;
    w[10]=P_q;
    w[11]=1./( - P_P*pow(P_p,2)*p_p + pow(P_p,4));
    w[12]=1./( - 1.6E+1*P_P*p_p + 1.6E+1*pow(P_p,2));
    w[13]=q_q;
   w[14]=w[7]*G;
   w[15]=w[14]*w[5];
   w[16]=w[15]*w[3];
   w[17]=w[14]*w[6];
   w[18]=w[17]*w[4];
   w[16]=w[18] - w[16];
   w[16]=w[1]*w[16];
   w[19]=2.E+0*w[5];
   w[19]=w[16]*w[19];
   w[20]=pow(w[4],2);
   w[21]=w[1]*G;
   w[22]=w[20]*w[21];
   w[19]=w[19] + w[22];
   w[21]=w[21]*w[3];
   w[22]=w[21]*w[2];
   w[23]=w[22] - w[19];
   w[24]=eta*w[23];
   w[25]=2.E+0*w[9];
   w[26]=w[16]*w[25];
   w[27]=w[4]*G;
   w[28]=w[27]*w[8];
   w[29]=w[28]*w[1];
   w[26]=w[26] + w[29];
   w[21]=w[21]*w[10];
   w[21]=w[21] - w[26];
   w[24]=w[24] + w[21];
   w[30]=svp*ssm;
   w[24]=w[24]*w[30];
   w[31]= - eta + 1.E+0;
   w[31]=w[23]*w[31];
   w[31]= - w[21] + w[31];
   w[32]=ssp*svm;
   w[31]=w[31]*w[32];
   w[24]=w[24] + w[31];
   w[31]=w[18]*w[25];
   w[31]=w[31] + w[28];
   w[33]=w[31]*w[2];
   w[34]=w[15]*w[20];
   w[35]=w[34]*w[25];
   w[33]=w[33] - w[35];
   w[36]=w[20]*G;
   w[37]=w[36]*w[10];
   w[38]=w[33] - w[37];
   w[39]=pow(w[5],2);
   w[20]=w[39]*w[20];
   w[40]=w[20]*w[14];
   w[41]=w[15]*w[6]*w[4];
   w[42]=w[41]*w[2];
   w[42]=w[42] - w[40];
   w[43]=2.E+0*w[42];
   w[44]=w[43]*eta;
   w[45]=w[44] + w[38];
   w[45]=w[45]*w[30];
   w[34]=w[34]*w[9];
   w[46]=w[34] - w[40];
   w[47]=w[18]*w[9];
   w[47]=w[47] - w[41];
   w[47]=w[28] + 2.E+0*w[47];
   w[47]=w[47]*w[2];
   w[46]= - w[47] + w[37] + 2.E+0*w[46];
   w[44]= - w[44] + w[46];
   w[44]=w[44]*w[32];
   w[44]=w[45] + w[44];
   w[44]=w[11]*w[44];
   w[45]=w[8]*w[12];
   w[39]=w[39]*w[14]*w[45];
   w[15]=w[15]*w[12];
   w[47]=w[4]*w[15]*w[9];
   w[39]=w[47] - w[39];
   w[17]=w[17]*w[12];
   w[25]=w[25]*w[17];
   w[45]=G*w[45];
   w[25]=w[25] - w[45];
   w[25]=w[25]*w[2];
   w[25]= - w[25] + 2.E+0*w[39];
   w[27]=w[27]*w[12];
   w[15]=w[15]*w[6];
   w[15]= - w[27] + 2.E+0*w[15];
   w[27]=w[15]*w[10];
   w[47]=w[25] + w[27];
   w[48]=8.E+0*w[47];
   w[49]=svm*svp;
   w[50]=w[49]*w[48];
   w[51]=w[2]*G;
   w[52]=w[51]*eta;
   w[53]=w[10]*G;
   w[54]=w[52] + w[53];
   w[54]= - w[54]*w[30];
   w[52]=w[52] - w[51];
   w[55]=w[53] + w[52];
   w[55]=w[55]*w[32];
   w[54]=w[54] + w[55];
   w[54]=3.E+0*w[54];
   w[55]=4.E+0*w[9];
   w[16]=w[16]*w[55];
   w[16]=2.E+0*w[29] + w[16] + w[23];
   w[16]=w[2]*w[16];
   w[29]=eta*w[2];
   w[56]= - w[23]*w[29];
   w[57]=w[10]*w[22];
   w[16]=w[56] + w[16] - 2.E+0*w[57];
   w[16]=eta*w[16];
   w[56]=w[23]*w[13];
   w[26]=w[26]*w[2];
   w[57]=w[56] - w[26];
   w[58]=w[22] - 2.E+0*w[21];
   w[58]=w[10]*w[58];
   w[16]=w[16] + w[58] + w[57];
   w[16]=w[16]*w[49];
   w[58]=ssp*ssm;
   w[59]= - w[23]*w[58];
   w[16]=w[16] + w[59];
   w[59]=w[41] - w[31];
   w[59]=w[2]*w[59];
   w[35]=w[37] + w[59] - w[40] + w[35];
   w[35]=w[2]*w[35];
   w[59]= - w[42]*w[29];
   w[35]=w[59] + w[35];
   w[35]=eta*w[35];
   w[33]=w[33]*w[2];
   w[59]=w[43]*w[13];
   w[60]=w[59] + w[33];
   w[18]= - w[18]*w[55];
   w[18]= - 2.E+0*w[28] - w[36] + w[18];
   w[18]=w[2]*w[18];
   w[18]=2.E+0*w[37] + 4.E+0*w[34] + w[18];
   w[18]=w[10]*w[18];
   w[18]=2.E+0*w[35] + w[18] + w[60];
   w[18]=w[18]*w[49];
   w[28]= - w[58]*w[43];
   w[18]=w[18] + w[28];
   w[18]=w[11]*w[18];
   w[28]= - w[30] - w[32];
   w[28]=w[28]*w[48];
   w[35]=w[53]*w[13];
   w[43]=G*pow(w[10],2);
   w[48]=eta*w[43];
   w[35]=w[35] + w[48];
   w[48]= - w[35]*w[30];
   w[35]= - w[43] + w[35];
   w[35]=w[35]*w[32];
   w[35]=w[48] + w[35];
   w[35]=3.E+0*w[35];
   w[48]=w[23] - w[21];
   w[48]=w[10]*w[48];
   w[61]=eta*w[10];
   w[23]=w[23]*w[61];
   w[23]=w[48] - 2.E+0*w[23];
   w[23]=w[13]*w[23];
   w[22]= - w[22] + 2.E+0*w[19];
   w[22]=w[22]*w[10];
   w[22]=w[22] - w[26];
   w[48]=w[61] - w[10];
   w[48]=w[48]*eta;
   w[22]=w[22]*w[48];
   w[22]=w[22] + w[23];
   w[22]=w[22]*w[49];
   w[23]=w[21]*w[10];
   w[62]= - w[58]*w[23];
   w[22]=w[22] + w[62];
   w[62]=w[36] + 4.E+0*w[41];
   w[62]=w[62]*w[2];
   w[62]=w[62] - 4.E+0*w[40];
   w[62]=w[62]*w[10];
   w[62]=w[62] - w[33];
   w[48]= - w[62]*w[48];
   w[46]=w[10]*w[46];
   w[42]=w[42]*w[61];
   w[42]=w[46] - 4.E+0*w[42];
   w[42]=w[13]*w[42];
   w[42]=w[48] + w[42];
   w[42]=w[42]*w[49];
   w[38]=w[38]*w[10];
   w[46]= - w[58]*w[38];
   w[42]=w[42] + w[46];
   w[42]=w[11]*w[42];
   w[46]=w[47]*w[10];
   w[48]=w[47]*w[61];
   w[61]= - w[46] + w[48];
   w[61]=w[61]*w[32];
   w[48]=w[30]*w[48];
   w[48]=w[48] + w[61];
   w[48]=8.E+0*w[48];
   w[51]=w[13]*w[51];
   w[43]= - w[43] + w[51];
   w[43]=6.E+0*w[43]*w[49];
   w[51]=w[19]*w[10];
   w[26]=w[51] - w[26];
   w[26]=w[26]*eta;
   w[19]= - w[21] + w[19];
   w[19]=w[10]*w[19];
   w[19]= - w[26] + w[19] + w[57];
   w[19]=w[19]*w[32];
   w[21]=w[56] - w[23] - w[26];
   w[21]=w[21]*w[30];
   w[19]=w[21] + w[19];
   w[19]=2.E+0*w[19];
   w[21]=w[36] + 2.E+0*w[41];
   w[23]=w[21]*w[2];
   w[14]=2.E+0*w[14];
   w[14]=w[20]*w[14];
   w[14]=w[23] - w[14];
   w[14]=w[14]*w[10];
   w[14]=w[14] - w[33];
   w[14]=w[14]*eta;
   w[20]=w[40] + w[34];
   w[21]= - w[31] - w[21];
   w[21]=w[2]*w[21];
   w[20]=w[37] + 2.E+0*w[20] + w[21];
   w[20]=w[10]*w[20];
   w[20]=w[14] + w[20] + w[60];
   w[20]=w[20]*w[32];
   w[14]=w[59] - w[38] + w[14];
   w[14]=w[14]*w[30];
   w[14]=w[14] + w[20];
   w[14]=2.E+0*w[11]*w[14];
   w[17]= - w[55]*w[17];
   w[15]=2.E+0*w[45] + w[17] - w[15];
   w[15]=w[2]*w[15];
   w[15]=2.E+0*w[27] + 4.E+0*w[39] + w[15];
   w[15]=w[10]*w[15];
   w[17]= - w[2]*w[25];
   w[20]=w[47]*w[29];
   w[15]=w[20] + w[17] + w[15];
   w[15]=eta*w[15];
   w[17]=w[13]*w[47];
   w[15]=w[17] - w[46] + w[15];
   w[15]=w[15]*w[49];
   w[17]= - w[47]*w[58];
   w[15]=w[15] + w[17];
   w[15]=1.6E+1*w[15];
   w[17]= - 2.E+0*w[53] - w[52];
   w[17]=eta*w[17];
   w[20]= - w[13]*G;
   w[17]=w[20] + w[53] + w[17];
   w[17]=w[17]*w[49];
   w[20]= - G*w[58];
   w[17]=w[17] + w[20];
   w[17]=3.E+0*w[17];

if(n_dirac > 0)
{
Ker[0][0] = jacobians * weights * prefactor
        * w[17];

if(n_dirac > 1){
Ker[0][1] = jacobians * weights * prefactor
        * w[54];

Ker[1][1] = jacobians * weights * prefactor
        * w[16];

Ker[1][0] = jacobians * weights * prefactor
        * w[24];


if(n_dirac > 2){
Ker[0][2] = jacobians * weights * prefactor
        * w[35];

Ker[2][0] = jacobians * weights * prefactor
        * w[44];

Ker[1][2] = jacobians * weights * prefactor
        * w[22];

Ker[2][1] = jacobians * weights * prefactor
        * w[18];

Ker[2][2] = jacobians * weights * prefactor
        * w[42];


if(n_dirac > 3){
Ker[0][3] = jacobians * weights * prefactor
        * w[43];

Ker[1][3] = jacobians * weights * prefactor
        * w[19];

Ker[2][3] = jacobians * weights * prefactor
        * w[14];

Ker[3][0] = jacobians * weights * prefactor
        * w[50];

Ker[3][1] = jacobians * weights * prefactor
        * w[28];

Ker[3][2] = jacobians * weights * prefactor
        * w[48];

Ker[3][3] = jacobians * weights * prefactor
        * w[15];

}
}
}
}







