
    w[1]=1./( - P_P*P_p*p_p + pow(P_p,3));
    w[2]=P_P;
    w[3]=p_p;
    w[4]=P_p;
    w[5]=P_k;
    w[6]=p_k;
    w[7]=pow(k_k,-1);
    w[8]=p_q;
    w[9]=q_k;
    w[10]=P_q;
    w[11]=1./( - P_P*p_p + pow(P_p,2));
    w[12]=1./( - 1.6E+1*P_P*p_p + 1.6E+1*pow(P_p,2));
    w[13]=q_q;
   w[14]=ssm*G;
   w[15]=svp*w[14];
   w[16]=G*svm;
   w[17]=w[16]*ssp;
   w[18]=w[15] + w[17];
   w[19]=w[9]*w[18];
   w[20]=w[18]*eta;
   w[20]=w[20] - w[17];
   w[21]=w[5]*w[20];
   w[19]=w[19] + w[21];
   w[21]=2.E+0*w[7];
   w[22]=w[21]*w[5];
   w[19]=w[19]*w[22];
   w[23]=w[10]*w[18];
   w[24]=w[2]*w[20];
   w[19]=w[19] + w[23] + w[24];
   w[19]=w[3]*w[19];
   w[23]= - w[8]*w[18];
   w[24]= - w[4]*w[20];
   w[23]=w[23] + w[24];
   w[23]=w[4]*w[23];
   w[24]=w[4]*w[9];
   w[25]=w[24]*w[18];
   w[26]=w[5]*w[4];
   w[27]=w[20]*w[26];
   w[25]=w[25] + w[27];
   w[27]=w[21]*w[6];
   w[28]= - w[25]*w[27];
   w[19]=w[19] + w[23] + w[28];
   w[19]=w[1]*w[19];
   w[23]= - w[5]*w[25];
   w[25]=w[9]*w[2];
   w[28]=w[18]*w[25];
   w[29]=w[5]*w[2];
   w[30]=w[20]*w[29];
   w[28]=w[28] + w[30];
   w[28]=w[6]*w[28];
   w[23]=w[23] + w[28];
   w[23]=w[23]*w[21];
   w[28]=w[4]*w[10];
   w[30]=w[8]*w[2];
   w[28]=w[28] - w[30];
   w[31]= - w[18]*w[28];
   w[23]=w[23] + w[31];
   w[23]=w[11]*w[23];
   w[31]=w[5]*w[8];
   w[31]=w[31] - w[24];
   w[31]=w[31]*w[5];
   w[32]=w[5]*w[10];
   w[32]= - w[25] + w[32];
   w[32]=w[6]*w[32];
   w[32]= - w[31] + w[32];
   w[16]=w[16]*svp;
   w[32]=w[21]*w[16]*w[32];
   w[28]= - w[16]*w[28];
   w[28]=w[32] + w[28];
   w[32]=8.E+0*w[12];
   w[28]=w[28]*w[32];
   w[33]=pow(w[10],2);
   w[34]= - w[18]*w[33];
   w[35]=w[2]*w[10];
   w[36]= - w[20]*w[35];
   w[34]=w[34] + w[36];
   w[34]=3.E+0*w[34];
   w[36]=eta*w[16];
   w[37]= - w[16] + 2.E+0*w[36];
   w[38]=w[37]*w[35];
   w[39]=2.E+0*w[16];
   w[40]=w[39]*w[33];
   w[38]=w[38] + w[40];
   w[40]=w[8]*w[38];
   w[41]=w[16]*w[13];
   w[14]=ssp*w[14];
   w[42]=w[41] + w[14];
   w[43]=w[42]*w[10];
   w[36]=w[36] - w[16];
   w[44]=w[36]*w[2]*eta;
   w[45]=w[10]*w[44];
   w[43]=w[43] - w[45];
   w[46]= - w[4]*w[43];
   w[40]=w[40] + w[46];
   w[40]=w[4]*w[40];
   w[46]=w[38]*w[24];
   w[47]=w[43]*w[26];
   w[46]=w[46] - w[47];
   w[47]=w[46]*w[27];
   w[48]= - w[9]*w[38];
   w[49]=w[5]*w[43];
   w[48]=w[48] + w[49];
   w[48]=w[48]*w[22];
   w[49]=w[37]*w[10];
   w[50]= - w[49] + w[42];
   w[50]=w[10]*w[50];
   w[50]=w[50] - w[45];
   w[50]=w[2]*w[50];
   w[39]=w[39]*pow(w[10],3);
   w[48]=w[48] - w[39] + w[50];
   w[48]=w[3]*w[48];
   w[40]=w[48] + w[40] + w[47];
   w[40]=w[1]*w[40];
   w[46]=w[5]*w[46];
   w[47]= - w[38]*w[25];
   w[43]=w[43]*w[29];
   w[43]=w[47] + w[43];
   w[43]=w[6]*w[43];
   w[43]=w[46] + w[43];
   w[43]=w[43]*w[21];
   w[38]= - w[38]*w[30];
   w[46]=w[2]*w[37]*w[33];
   w[39]=w[39] + w[46];
   w[39]=w[4]*w[39];
   w[38]=w[43] + w[38] + w[39];
   w[38]=w[11]*w[38];
   w[15]=w[15] - w[17];
   w[39]=w[15]*w[10];
   w[43]=w[39]*w[31];
   w[46]=w[35]*w[15];
   w[47]=w[9]*w[46];
   w[48]=w[33]*w[15];
   w[50]= - w[5]*w[48];
   w[47]=w[47] + w[50];
   w[47]=w[6]*w[47];
   w[43]=w[43] + w[47];
   w[43]=w[43]*w[21];
   w[46]= - w[8]*w[46];
   w[47]=w[4]*w[48];
   w[43]=w[43] + w[46] + w[47];
   w[43]=w[43]*w[32];
   w[18]= - w[13]*w[18];
   w[20]= - w[10]*w[20];
   w[18]=w[18] + w[20];
   w[18]=3.E+0*w[18];
   w[14]=w[41] - w[14];
   w[20]=w[14] - w[44];
   w[46]=w[8]*w[20];
   w[36]=eta*w[36]*w[10];
   w[37]=w[37]*w[13];
   w[47]=w[37] + 2.E+0*w[36];
   w[50]=w[4]*w[47];
   w[46]=w[46] + w[50];
   w[46]=w[4]*w[46];
   w[50]=w[47]*w[26];
   w[51]=w[20]*w[24];
   w[50]=w[50] + w[51];
   w[51]=w[50]*w[27];
   w[52]= - w[9]*w[20];
   w[53]= - w[5]*w[47];
   w[52]=w[52] + w[53];
   w[52]=w[52]*w[22];
   w[36]= - w[37] - w[36];
   w[36]=w[2]*w[36];
   w[37]=w[14]*w[10];
   w[36]=w[52] - w[37] + w[36];
   w[36]=w[3]*w[36];
   w[36]=w[36] + w[46] + w[51];
   w[36]=w[1]*w[36];
   w[46]=w[5]*w[50];
   w[50]= - w[20]*w[25];
   w[47]= - w[47]*w[29];
   w[47]=w[50] + w[47];
   w[47]=w[6]*w[47];
   w[46]=w[46] + w[47];
   w[46]=w[46]*w[21];
   w[20]= - w[20]*w[30];
   w[37]=w[37] - w[45];
   w[37]=w[4]*w[37];
   w[20]=w[46] + w[20] + w[37];
   w[20]=w[11]*w[20];
   w[37]=w[15]*eta;
   w[17]=w[37] + w[17];
   w[37]= - w[17]*w[31];
   w[46]= - w[17]*w[25];
   w[47]=w[17]*w[10];
   w[50]=w[5]*w[47];
   w[46]=w[46] + w[50];
   w[46]=w[6]*w[46];
   w[37]=w[37] + w[46];
   w[37]=w[37]*w[21];
   w[46]=w[17]*w[30];
   w[50]= - w[4]*w[47];
   w[37]=w[37] + w[46] + w[50];
   w[32]=w[37]*w[32];
   w[16]= - w[33]*w[16];
   w[33]=w[2]*w[41];
   w[16]=w[16] + w[33];
   w[16]=6.E+0*w[16];
   w[33]=w[17]*w[2];
   w[33]=w[33] + w[39];
   w[37]=w[8]*w[33];
   w[15]=w[15]*w[13];
   w[39]=w[15] + w[47];
   w[41]= - w[4]*w[39];
   w[37]=w[37] + w[41];
   w[37]=w[4]*w[37];
   w[24]=w[33]*w[24];
   w[26]=w[39]*w[26];
   w[24]=w[24] - w[26];
   w[26]=w[24]*w[27];
   w[27]= - w[9]*w[33];
   w[41]=w[5]*w[39];
   w[27]=w[27] + w[41];
   w[22]=w[27]*w[22];
   w[15]=w[2]*w[15];
   w[15]=w[22] - w[48] + w[15];
   w[15]=w[3]*w[15];
   w[15]=w[15] + w[37] + w[26];
   w[15]=2.E+0*w[1]*w[15];
   w[22]=w[5]*w[24];
   w[24]= - w[33]*w[25];
   w[26]=w[39]*w[29];
   w[24]=w[24] + w[26];
   w[24]=w[6]*w[24];
   w[22]=w[22] + w[24];
   w[22]=w[22]*w[21];
   w[24]= - w[33]*w[30];
   w[17]=w[17]*w[35];
   w[17]=w[48] + w[17];
   w[17]=w[4]*w[17];
   w[17]=w[22] + w[24] + w[17];
   w[17]=2.E+0*w[11]*w[17];
   w[22]=w[49] + w[42];
   w[24]=w[22] + w[44];
   w[25]= - w[24]*w[25];
   w[22]=w[22]*w[10];
   w[22]=w[22] + w[45];
   w[26]=w[5]*w[22];
   w[25]=w[25] + w[26];
   w[25]=w[6]*w[25];
   w[26]= - w[24]*w[31];
   w[25]=w[26] + w[25];
   w[21]=w[25]*w[21];
   w[24]=w[24]*w[30];
   w[22]= - w[4]*w[22];
   w[21]=w[21] + w[24] + w[22];
   w[21]=1.6E+1*w[12]*w[21];
   w[14]= - w[44] - w[49] - w[14];
   w[14]=3.E+0*w[14];

kernel[SI_kernel(ip,izp,0,iq,izq,0)] += jacobians * weights * prefactor
* w[14];

if(n_dirac > 1)
{

kernel[SI_kernel(ip,izp,0,iq,izq,1)] += jacobians * weights * prefactor
* w[34];

kernel[SI_kernel(ip,izp,0,iq,izq,2)] += jacobians * weights * prefactor
* w[18];

kernel[SI_kernel(ip,izp,0,iq,izq,3)] += jacobians * weights * prefactor
* w[16];

kernel[SI_kernel(ip,izp,1,iq,izq,0)] += jacobians * weights * prefactor
* w[19];

kernel[SI_kernel(ip,izp,1,iq,izq,1)] += jacobians * weights * prefactor
* w[40];

kernel[SI_kernel(ip,izp,1,iq,izq,2)] += jacobians * weights * prefactor
* w[36];

kernel[SI_kernel(ip,izp,1,iq,izq,3)] += jacobians * weights * prefactor
* w[15];

kernel[SI_kernel(ip,izp,2,iq,izq,0)] += jacobians * weights * prefactor
* w[23];

kernel[SI_kernel(ip,izp,2,iq,izq,1)] += jacobians * weights * prefactor
* w[38];

kernel[SI_kernel(ip,izp,2,iq,izq,2)] += jacobians * weights * prefactor
* w[20];

kernel[SI_kernel(ip,izp,2,iq,izq,3)] += jacobians * weights * prefactor
* w[17];

kernel[SI_kernel(ip,izp,3,iq,izq,0)] += jacobians * weights * prefactor
* w[28];

kernel[SI_kernel(ip,izp,3,iq,izq,1)] += jacobians * weights * prefactor
* w[43];

kernel[SI_kernel(ip,izp,3,iq,izq,2)] += jacobians * weights * prefactor
* w[32];

kernel[SI_kernel(ip,izp,3,iq,izq,3)] += jacobians * weights * prefactor
* w[21];

}
